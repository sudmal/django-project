{% extends 'main/base.html' %}

{% load bold_in_quotes %}
{% load render_table from django_tables2 %}
{% load static %}
{% load cache %}
{% load querystring from django_tables2 %}

{% block title %}
    Продажи :: Топ продаж для {{ firm }}
{% endblock title %}

{% block js-before %}
<link rel="stylesheet" href="{% static 'django_tables2/themes/paleblue/css/screen.css' %}" />
<style> 
.container { 
padding-left: 16px; 
padding-right: 16px;
marging-left: 16px; 
marging-right: 16px; 
overflow: hidden;
} 
.container-fluid { 
padding-left: 16px; 
padding-right: 16px;
marging-left: 16px; 
marging-right: 16px; 
overflow: hidden;
} 
.div-cell-right {
     text-align: right; 
     vertical-align: middle; 
     border-bottom: 1px solid lightgrey;
     border-left: 1px solid lightgrey;
     padding: 5 px;
}
.div-cell-left {
     text-align: left; 
     vertical-align: middle; 
     border-bottom: 1px solid lightgrey;
     border-left: 1px solid lightgrey;
     padding: 5 px;
}

.highlight { background-color: #c8f6cd; }
</style>
{% endblock js-before %}

{% block export_button %}
{% if top_records %}
    <a href="{% querystring '_export'='xlsx' %}"><button type="button" class="btn btn-outline-success">Export to EXCEL</button></a>
{% endif %}
{% endblock export_button %}

{% block DatePeriod %}
    <form method="get" class="form-inline" action={% url 'inner:topSalesFirmShow' edrpou_num %}>
    {% csrf_token %}    
         {{ period_form.start_date }}
        -
        {{ period_form.end_date }}
        <button type="submit" class="btn btn-info">Изменить</button>
    </form>
{% endblock DatePeriod %}

{% block period_button %}
{% endblock period_button %}

{% block content %}
<div class="container-fluid p-0">
  <div class="row">
        <div class="col"></div>
        <div class="col-md-10">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><span style="color: green;">Топ продаж [{{start_date|date}} - {{end_date|date}}] организации (<b>{{ firm }}</b>)</span></li>
                    <li class="breadcrumb-item"><span style="color: green;">С учетом НДС, валюта (<b>{{ currency }}</b>)</span></li>
                    <li class="breadcrumb-item"><span style="color: green;">Сумма продаж по позиции больше 300 000 грн или количество <b>от 100 единиц</b>.</span></li>
                </ol>
            </nav> 
        </div>
        <div class="col"></div>
    </div>
</div>
    <div  class="container-fluid" style="margin: auto;">
    {% if top_records %}
        
        <div class="table  table-stripped">
            <div class="row thead border-bottom-0" >
                <div class="col-md-1"></div>
                <div class="col-md-1 div-cell-right" style="background-color: darkgrey; color: white;">
                    №
                </div>
                <div class="col-md-5 div-cell-left" style="background-color: darkgrey; color: white;">
                    Наименование
                </div>
                <div class="col-md-2 div-cell-right" style="background-color: darkgrey; color: white;">
                    Количество
                </div>
                <div class="col-md-2 div-cell-right" style="background-color: darkgrey; color: white;">
                    На сумму (UAH)
                </div>
                <div class="col-md-1"></div>
        </div>
        {% for row in top_records %}
                <div class="row">
                    <div class="col-md-1 py-0"></div>
                    <div class="col-md-1 py-0 div-cell-right" style="background-color: {% cycle '#e9e9e9' '#d5d5d5'  %}">
                        {{forloop.counter}}
                    </div>
                    <div class="col-md-5 py-0 div-cell-left" style="background-color: {% cycle '#e9e9e9' '#d5d5d5'  %}">
                        <span class="text-capitalize font-weight-bold"><a style="color:black" href="{% url 'inner:RecordsSearch' %}?search_string={{row.product__name}}"> {{row.product__name}}</a></span>
                    </div>
                        <div class="col-md-2 py-0 div-cell-right" style="background-color: {% cycle '#e9e9e9' '#d5d5d5'  %}">
                        {{row.total_count}}
                    </div>
                        <div class="col-md-2 py-0 div-cell-right" style="background-color: {% cycle '#e9e9e9' '#d5d5d5'  %}" style="border-right: 1px solid lightgrey;">
                        {{row.total_cost}}
                    </div>
                    <div class="col-md-1 py-0"></div>
                </div>
        {% endfor %}
        </div>
    {% else %}
        По заданному запросу за выбранный период записей не обнаружено
    {% endif %}
    </div>




{% endblock content %}


{% block js %}
<script>
$('td').highlight('{{ request.GET.search_string }}');

</script>
{% endblock js %}
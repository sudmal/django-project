{% extends 'main/base.html' %}

{% load bold_in_quotes %}
{% load static %}
{% load cache %}

{% block title %}
ВЭД :: Конкуренты :: Индивидуальный анализ
{% endblock title %}

{% block DatePeriod %}
    <form method="get" action={% url 'ved:IndividualReport' %}>
         {{ search_form.start_date }}
        -
        {{ search_form.end_date }}
        <button type="submit" class="btn btn-info">Изменить</button>

{% endblock DatePeriod %}

{% block content %}

<div class="container m-2">
   ВЭД :: Конкуренты :: Индивидуальный анализ 
</div>
<div data-date="12/03/2012"></div>
<div class="container">

    <div class="col-md-4">
        <div class="form-group">
        {{ search_form.search_string }} <button type="submit" class="btn btn-primary" style="display: inline">Поиск</button>
        </div>
    </div>
    <div class="col-md-4">
        
    </div>
    </form>

{% if grecords.object_list %}


</div>
<div class="container-fluid">
    <table class="table table-striped border border-secondary">
        <thead>
            <tr>
                <th>№</th>
                <th>ЕДРПОУ</th>
                <th>Наименование организации</th>
                <th>Торговые марки</th>
                <th>Записей</th>
                <th>На сумму, $</th>
                <th>Конкурент</th>
            </tr>
        </thead>
        <tbody>
        
        {% for gr in grecords %}
                    <tr>
                        <td scope="row">
                            {{ forloop.counter0|add:grecords.start_index }}
                        </td>
                        <td>
                            <a class="btn btn-primary font-weight-bold" href="{% url 'ved:IndividualReportFirmShow' gr.record__recipient__edrpou %}?start_date={{ start_date }}&end_date={{ end_date }}">{{ gr.record__recipient__edrpou | cut:' ' }}</a> 
                        </td>
                        <td ><span class="h6">{% autoescape off %} {{ gr.record__recipient__name | bold_in_quotes }} {% endautoescape %}</span></td>
                        <td>
                        
                        {% for tm in gr.tms %}
                            {% if forloop.counter <= 5  %}
                                <div class="border border-secondary rounded p-1 bg-light font-weight-bold">{{tm}}</div>
                            {% endif %}
                        {% endfor %}
                        {% if  gr.tms_count > 5 %}
                         ... ({{gr.tms_count}})
                        {% endif %}
                         
                        </td>
                         <td>
                            {{ gr.count }}
                        </td>
                        <td>
                            {{ gr.total_cost }}
                        </td>
                        <td>
                        {% if gr.record__recipient__is_competitor %} 
                            <img src="{% static 'yes.png' %}" alt="yes"> 
                        {% else %}
                            <img src="{% static 'no.png' %}" alt="no">
                        {% endif %}
                        </td>

                    </tr>
                {% endfor %}
            </tbody>
        </table>
    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
            {% if grecords.has_previous %}
                <li class="page-item">
                    <a class="page-link" href="?page=1&search_string={{ search_string|urlencode:"" }}&start_date={{ start_date }}&end_date={{ end_date }}">&laquo;</a>
                </li>
                <li class="page-item">
                    <a class="page-link" href="?page={{ grecords.previous_page_number }}&search_string={{ search_string|urlencode:"" }}&start_date={{ start_date }}&end_date={{ end_date }}"> < </a>
                </li>
            {% endif %}

            <li class="page-item">
                <a class="page-link disabled" href="#"> Page {{ grecords.number }} of {{ grecords.paginator.num_pages }}</a>
            </li>

            {% if grecords.has_next %}
                <li class="page-item">
                    <a class="page-link" href="?page={{ grecords.next_page_number }}&search_string={{ search_string|urlencode:"" }}&start_date={{ start_date }}&end_date={{ end_date }}"> > </a>
                </li>
                <li class="page-item">
                    <a class="page-link" href="?page={{ grecords.paginator.num_pages }}&search_string={{ search_string|urlencode:"" }}&start_date={{ start_date }}&end_date={{ end_date }}"> &raquo; </a>
                </li>
            {% endif %}
        </ul>
    </nav>  
{% else %}
<div class='warning'>
    Извините, по данному запросу ничего не найдено
</div>


 </div>
{% endif %}

 {% include 'ved/periods.html' %}



{% endblock content %}

{% block js %}
{% endblock js %}

